{"version":3,"file":"directionality.spec.js","sourceRoot":"","sources":["../../../../src/cdk/bidi/directionality.spec.ts"],"names":[],"mappings":"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","sourcesContent":["import {async, fakeAsync, TestBed} from '@angular/core/testing';\r\nimport {Component, ViewChild} from '@angular/core';\r\nimport {By} from '@angular/platform-browser';\r\nimport {BidiModule, Directionality, Dir, Direction, DIR_DOCUMENT} from './index';\r\n\r\ndescribe('Directionality', () => {\r\n  let fakeDocument: FakeDocument;\r\n\r\n  beforeEach(async(() => {\r\n    fakeDocument = {body: {}, documentElement: {}};\r\n\r\n    TestBed.configureTestingModule({\r\n      imports: [BidiModule],\r\n      declarations: [ElementWithDir, InjectsDirectionality],\r\n      providers: [{provide: DIR_DOCUMENT, useFactory: () => fakeDocument}],\r\n    }).compileComponents();\r\n  }));\r\n\r\n  describe('Service', () => {\r\n    it('should read dir from the html element if not specified on the body', () => {\r\n      fakeDocument.documentElement.dir = 'rtl';\r\n\r\n      const fixture = TestBed.createComponent(InjectsDirectionality);\r\n      const testComponent = fixture.debugElement.componentInstance;\r\n\r\n      expect(testComponent.dir.value).toBe('rtl');\r\n    });\r\n\r\n    it('should read dir from the body even it is also specified on the html element', () => {\r\n      fakeDocument.documentElement.dir = 'ltr';\r\n      fakeDocument.body.dir = 'rtl';\r\n\r\n      const fixture = TestBed.createComponent(InjectsDirectionality);\r\n      const testComponent = fixture.debugElement.componentInstance;\r\n\r\n      expect(testComponent.dir.value).toBe('rtl');\r\n    });\r\n\r\n    it('should default to ltr if nothing is specified on either body or the html element', () => {\r\n      const fixture = TestBed.createComponent(InjectsDirectionality);\r\n      const testComponent = fixture.debugElement.componentInstance;\r\n\r\n      expect(testComponent.dir.value).toBe('ltr');\r\n    });\r\n\r\n    it('should complete the `change` stream on destroy', () => {\r\n      const fixture = TestBed.createComponent(InjectsDirectionality);\r\n      const spy = jasmine.createSpy('complete spy');\r\n      const subscription =\r\n          fixture.componentInstance.dir.change.subscribe(undefined, undefined, spy);\r\n\r\n      fixture.componentInstance.dir.ngOnDestroy();\r\n      expect(spy).toHaveBeenCalled();\r\n\r\n      subscription.unsubscribe();\r\n    });\r\n\r\n    it('should default to ltr if an invalid direction is set on the body', () => {\r\n      fakeDocument.body.dir = 'not-valid';\r\n\r\n      const fixture = TestBed.createComponent(InjectsDirectionality);\r\n      const testComponent = fixture.debugElement.componentInstance;\r\n\r\n      expect(testComponent.dir.value).toBe('ltr');\r\n    });\r\n\r\n  });\r\n\r\n  describe('Dir directive', () => {\r\n    it('should provide itself as Directionality', () => {\r\n      const fixture = TestBed.createComponent(ElementWithDir);\r\n      const injectedDirectionality =\r\n        fixture.debugElement.query(By.directive(InjectsDirectionality)).componentInstance.dir;\r\n\r\n      fixture.detectChanges();\r\n\r\n      expect(injectedDirectionality.value).toBe('rtl');\r\n    });\r\n\r\n    it('should emit a change event when the value changes', fakeAsync(() => {\r\n      const fixture = TestBed.createComponent(ElementWithDir);\r\n      const injectedDirectionality =\r\n        fixture.debugElement.query(By.directive(InjectsDirectionality)).componentInstance.dir;\r\n\r\n      fixture.detectChanges();\r\n\r\n      let direction = injectedDirectionality.value;\r\n      injectedDirectionality.change.subscribe((dir: Direction) => { direction = dir; });\r\n\r\n      expect(direction).toBe('rtl');\r\n      expect(injectedDirectionality.value).toBe('rtl');\r\n      expect(fixture.componentInstance.changeCount).toBe(0);\r\n\r\n      fixture.componentInstance.direction = 'ltr';\r\n\r\n      fixture.detectChanges();\r\n\r\n      expect(direction).toBe('ltr');\r\n      expect(injectedDirectionality.value).toBe('ltr');\r\n      expect(fixture.componentInstance.changeCount).toBe(1);\r\n    }));\r\n\r\n    it('should complete the change stream on destroy', fakeAsync(() => {\r\n      const fixture = TestBed.createComponent(ElementWithDir);\r\n      const dir =\r\n        fixture.debugElement.query(By.directive(InjectsDirectionality)).componentInstance.dir;\r\n      const spy = jasmine.createSpy('complete spy');\r\n      const subscription = dir.change.subscribe(undefined, undefined, spy);\r\n\r\n      fixture.destroy();\r\n      expect(spy).toHaveBeenCalled();\r\n      subscription.unsubscribe();\r\n    }));\r\n\r\n    it('should default to ltr if an invalid value is passed in', () => {\r\n      const fixture = TestBed.createComponent(ElementWithDir);\r\n\r\n      fixture.detectChanges();\r\n      expect(fixture.componentInstance.dir.value).toBe('rtl');\r\n\r\n      fixture.componentInstance.direction = 'not-valid';\r\n      fixture.detectChanges();\r\n      expect(fixture.componentInstance.dir.value).toBe('ltr');\r\n    });\r\n\r\n  });\r\n});\r\n\r\n\r\n@Component({\r\n  template: `\r\n    <div [dir]=\"direction\" (dirChange)=\"changeCount = changeCount + 1\">\r\n      <injects-directionality></injects-directionality>\r\n    </div>\r\n  `\r\n})\r\nclass ElementWithDir {\r\n  @ViewChild(Dir) dir: Dir;\r\n  direction = 'rtl';\r\n  changeCount = 0;\r\n}\r\n\r\n/** Test component with Dir directive. */\r\n@Component({\r\n  selector: 'injects-directionality',\r\n  template: `<div></div>`\r\n})\r\nclass InjectsDirectionality {\r\n  constructor(public dir: Directionality) { }\r\n}\r\n\r\ninterface FakeDocument {\r\n  documentElement: {dir?: string};\r\n  body: {dir?: string};\r\n}\r\n"]}