{"version":3,"file":"tree-flat-overview-example.js","sourceRoot":"","sources":["../../../../src/material-examples/tree-flat-overview/tree-flat-overview-example.ts"],"names":[],"mappings":";;AAAA,0CAAkD;AAClD,sCAAoD;AACpD,+CAA+E;AAC/E,6BAAqE;;;;;AAMrE;;;;AAAA;;;mBATA;IAaC,CAAA;AAJY,4BAAQ;;AAOrB;AAAA;IACE,sBACS,UAAmB,EAAS,QAAgB,EAAS,KAAa,EAAS,IAAS;QAApF,eAAU,GAAV,UAAU,CAAS;QAAS,aAAQ,GAAR,QAAQ,CAAQ;QAAS,UAAK,GAAL,KAAK,CAAQ;QAAS,SAAI,GAAJ,IAAI,CAAK;KAAI;uBAlBnG;IAmBC,CAAA;AAHY,oCAAY;;;;AAQzB,IAAM,SAAS,GAAG,IAAI,CAAC,SAAS,CAAC;IAC/B,YAAY,EAAE;QACZ,QAAQ,EAAE,KAAK;QACf,MAAM,EAAE,KAAK;QACb,QAAQ,EAAE,KAAK;KAChB;IACD,SAAS,EAAE;QACT,OAAO,EAAE;YACP,GAAG,EAAE;gBACH,QAAQ,EAAE,IAAI;gBACd,IAAI,EAAE,IAAI;aACX;SACF;QACD,SAAS,EAAE;YACT,GAAG,EAAE;gBACH,MAAM,EAAE,IAAI;gBACZ,QAAQ,EAAE,IAAI;gBACd,KAAK,EAAE,IAAI;aACZ;SACF;KACF;IACD,SAAS,EAAE;QACT,OAAO,EAAE,KAAK;QACd,QAAQ,EAAE,KAAK;QACf,QAAQ,EAAE,MAAM;KACjB;IACD,QAAQ,EAAE;QACR,qBAAqB,EAAE;YACrB,QAAQ,EAAE,KAAK;YACf,QAAQ,EAAE,KAAK;SAChB;QACD,GAAG,EAAE,KAAK;QACV,KAAK,EAAE,KAAK;KACb;CACF,CAAC,CAAC;;;;;;;;;IAeD;0BAJa,IAAI,sBAAe,CAAa,EAAE,CAAC;QAK9C,IAAI,CAAC,UAAU,EAAE,CAAC;KACnB;IAJD,sBAAI,8BAAI;aAAR,cAAyB,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,EAAE;;;OAAA;IAMxD,iCAAU,GAAV;;QAEE,IAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;;;QAIzC,IAAM,IAAI,GAAG,IAAI,CAAC,aAAa,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;;QAG/C,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;KAC5B;IAED;;;OAGG;;;;;IACH,oCAAa;;;;IAAb,UAAc,GAAW,EAAE,KAAa;QAAxC,iBAgBC;QAfC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,MAAM,CAAa,UAAC,WAAW,EAAE,GAAG;YAC1D,IAAM,KAAK,GAAG,GAAG,CAAC,GAAG,CAAC,CAAC;YACvB,IAAM,IAAI,GAAG,IAAI,QAAQ,EAAE,CAAC;YAC5B,IAAI,CAAC,QAAQ,GAAG,GAAG,CAAC;YAEpB,EAAE,CAAC,CAAC,KAAK,IAAI,IAAI,CAAC,CAAC,CAAC;gBAClB,EAAE,CAAC,CAAC,OAAO,KAAK,KAAK,QAAQ,CAAC,CAAC,CAAC;oBAC9B,IAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,aAAa,CAAC,KAAK,EAAE,KAAK,GAAG,CAAC,CAAC,CAAC;iBACtD;gBAAC,IAAI,CAAC,CAAC;oBACN,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC;iBACnB;aACF;YAED,MAAM,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;SACjC,EAAE,EAAE,CAAC,CAAC;KACR;;gBA1CF,iBAAU;;;;uBAnEX;;AAoEa,oCAAY;;;;;IA0DvB,iCAAY,QAAsB;QAAlC,iBAOC;2BAEa,UAAC,IAAc,EAAE,KAAa;YAC1C,MAAM,CAAC,IAAI,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;SAC3E;yBAEmB,UAAC,IAAkB,IAAK,OAAA,IAAI,CAAC,KAAK,EAAV,CAAU;6BAE9B,UAAC,IAAkB,IAAK,OAAA,IAAI,CAAC,UAAU,EAAf,CAAe;4BAExC,UAAC,IAAc,IAA6B,OAAA,SAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,EAA3B,CAA2B;wBAEnF,UAAC,CAAS,EAAE,SAAuB,IAAK,OAAA,SAAS,CAAC,UAAU,EAApB,CAAoB;QAlBrE,IAAI,CAAC,aAAa,GAAG,IAAI,uBAAgB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,EACxE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;QACzC,IAAI,CAAC,WAAW,GAAG,IAAI,sBAAe,CAAe,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QACzF,IAAI,CAAC,UAAU,GAAG,IAAI,4BAAqB,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,aAAa,CAAC,CAAC;QAElF,QAAQ,CAAC,UAAU,CAAC,SAAS,CAAC,UAAA,IAAI,IAAI,OAAA,KAAI,CAAC,UAAU,CAAC,IAAI,GAAG,IAAI,EAA3B,CAA2B,CAAC,CAAC;KACpE;;gBAlBF,gBAAS,SAAC;oBACT,QAAQ,EAAE,4BAA4B;oBACtC,WAAW,EAAE,iCAAiC;oBAC9C,SAAS,EAAE,CAAC,gCAAgC,CAAC;oBAC7C,SAAS,EAAE,CAAC,YAAY,CAAC;iBAC1B;;;;gBApDY,YAAY;;kCApEzB;;AAyHa,0DAAuB","sourcesContent":["import {FlatTreeControl} from '@angular/cdk/tree';\r\nimport {Component, Injectable} from '@angular/core';\r\nimport {MatTreeFlatDataSource, MatTreeFlattener} from '@angular/material/tree';\r\nimport {BehaviorSubject, Observable, of as observableOf} from 'rxjs';\r\n\r\n/**\r\n * File node data with nested structure.\r\n * Each node has a filename, and a type or a list of children.\r\n */\r\nexport class FileNode {\r\n  children: FileNode[];\r\n  filename: string;\r\n  type: any;\r\n}\r\n\r\n/** Flat node with expandable and level information */\r\nexport class FileFlatNode {\r\n  constructor(\r\n    public expandable: boolean, public filename: string, public level: number, public type: any) {}\r\n}\r\n\r\n/**\r\n * The file structure tree data in string. The data could be parsed into a Json object\r\n */\r\nconst TREE_DATA = JSON.stringify({\r\n  Applications: {\r\n    Calendar: 'app',\r\n    Chrome: 'app',\r\n    Webstorm: 'app'\r\n  },\r\n  Documents: {\r\n    angular: {\r\n      src: {\r\n        compiler: 'ts',\r\n        core: 'ts'\r\n      }\r\n    },\r\n    material2: {\r\n      src: {\r\n        button: 'ts',\r\n        checkbox: 'ts',\r\n        input: 'ts'\r\n      }\r\n    }\r\n  },\r\n  Downloads: {\r\n    October: 'pdf',\r\n    November: 'pdf',\r\n    Tutorial: 'html'\r\n  },\r\n  Pictures: {\r\n    'Photo Booth Library': {\r\n      Contents: 'dir',\r\n      Pictures: 'dir'\r\n    },\r\n    Sun: 'png',\r\n    Woods: 'jpg'\r\n  }\r\n});\r\n\r\n/**\r\n * File database, it can build a tree structured Json object from string.\r\n * Each node in Json object represents a file or a directory. For a file, it has filename and type.\r\n * For a directory, it has filename and children (a list of files or directories).\r\n * The input will be a json object string, and the output is a list of `FileNode` with nested\r\n * structure.\r\n */\r\n@Injectable()\r\nexport class FileDatabase {\r\n  dataChange = new BehaviorSubject<FileNode[]>([]);\r\n\r\n  get data(): FileNode[] { return this.dataChange.value; }\r\n\r\n  constructor() {\r\n    this.initialize();\r\n  }\r\n\r\n  initialize() {\r\n    // Parse the string to json object.\r\n    const dataObject = JSON.parse(TREE_DATA);\r\n\r\n    // Build the tree nodes from Json object. The result is a list of `FileNode` with nested\r\n    //     file node as children.\r\n    const data = this.buildFileTree(dataObject, 0);\r\n\r\n    // Notify the change.\r\n    this.dataChange.next(data);\r\n  }\r\n\r\n  /**\r\n   * Build the file structure tree. The `value` is the Json object, or a sub-tree of a Json object.\r\n   * The return value is the list of `FileNode`.\r\n   */\r\n  buildFileTree(obj: object, level: number): FileNode[] {\r\n    return Object.keys(obj).reduce<FileNode[]>((accumulator, key) => {\r\n      const value = obj[key];\r\n      const node = new FileNode();\r\n      node.filename = key;\r\n\r\n      if (value != null) {\r\n        if (typeof value === 'object') {\r\n          node.children = this.buildFileTree(value, level + 1);\r\n        } else {\r\n          node.type = value;\r\n        }\r\n      }\r\n\r\n      return accumulator.concat(node);\r\n    }, []);\r\n  }\r\n}\r\n\r\n/**\r\n * @title Tree with flat nodes\r\n */\r\n@Component({\r\n  selector: 'tree-flat-overview-example',\r\n  templateUrl: 'tree-flat-overview-example.html',\r\n  styleUrls: ['tree-flat-overview-example.css'],\r\n  providers: [FileDatabase]\r\n})\r\nexport class TreeFlatOverviewExample {\r\n  treeControl: FlatTreeControl<FileFlatNode>;\r\n  treeFlattener: MatTreeFlattener<FileNode, FileFlatNode>;\r\n  dataSource: MatTreeFlatDataSource<FileNode, FileFlatNode>;\r\n\r\n  constructor(database: FileDatabase) {\r\n    this.treeFlattener = new MatTreeFlattener(this.transformer, this._getLevel,\r\n      this._isExpandable, this._getChildren);\r\n    this.treeControl = new FlatTreeControl<FileFlatNode>(this._getLevel, this._isExpandable);\r\n    this.dataSource = new MatTreeFlatDataSource(this.treeControl, this.treeFlattener);\r\n\r\n    database.dataChange.subscribe(data => this.dataSource.data = data);\r\n  }\r\n\r\n  transformer = (node: FileNode, level: number) => {\r\n    return new FileFlatNode(!!node.children, node.filename, level, node.type);\r\n  }\r\n\r\n  private _getLevel = (node: FileFlatNode) => node.level;\r\n\r\n  private _isExpandable = (node: FileFlatNode) => node.expandable;\r\n\r\n  private _getChildren = (node: FileNode): Observable<FileNode[]> => observableOf(node.children);\r\n\r\n  hasChild = (_: number, _nodeData: FileFlatNode) => _nodeData.expandable;\r\n}\r\n"]}